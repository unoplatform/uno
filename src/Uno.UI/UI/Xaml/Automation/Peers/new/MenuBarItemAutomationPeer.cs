// <auto-generated>
#pragma warning disable 108 // new keyword hiding
#pragma warning disable 114 // new keyword hiding
using System;
using Microsoft.UI.Xaml.Automation;
using Microsoft.UI.Xaml.Automation.Provider;
using Microsoft.UI.Xaml.Controls;

namespace Microsoft.UI.Xaml.Automation.Peers;

public partial class MenuBarItemAutomationPeer : FrameworkElementAutomationPeer, IExpandCollapseProvider, IInvokeProvider
{
	public MenuBarItemAutomationPeer(MenuBarItem owner) : base(owner)
	{
		ArgumentNullException.ThrowIfNull(owner);
	}

	protected override AutomationControlType GetAutomationControlTypeCore()
		=> AutomationControlType.MenuItem;

	protected override string GetClassNameCore()
		=> nameof(MenuBarItem);

	protected override string GetNameCore()
	{
		var name = base.GetNameCore();
		return !string.IsNullOrWhiteSpace(name)
			? name
			: MenuBarItemOwner?.Title ?? string.Empty;
	}

	protected override object GetPatternCore(PatternInterface patternInterface)
	{
		if (patternInterface is PatternInterface.ExpandCollapse or PatternInterface.Invoke)
		{
			return this;
		}

		return base.GetPatternCore(patternInterface);
	}

	public ExpandCollapseState ExpandCollapseState
		=> MenuBarItemOwner?.IsFlyoutOpen() == true ? ExpandCollapseState.Expanded : ExpandCollapseState.Collapsed;

	public void Collapse() => GetOwnerOrThrow().CloseMenuFlyout();

	public void Expand() => GetOwnerOrThrow().ShowMenuFlyout();

	public void Invoke() => GetOwnerOrThrow().Invoke();

	private MenuBarItem GetOwnerOrThrow()
		=> MenuBarItemOwner ?? throw new InvalidOperationException("MenuBarItemAutomationPeer has no owner.");

	private MenuBarItem? MenuBarItemOwner => Owner as MenuBarItem;
}
