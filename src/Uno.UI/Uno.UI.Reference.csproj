<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<TargetFrameworks>$(NetReferencePreviousAndCurrent)</TargetFrameworks>
		<DefineConstants>$(DefineConstants);ENABLE_LEGACY_TEMPLATED_PARENT_SUPPORT</DefineConstants>
	</PropertyGroup>

	<Import Project="../targetframework-override.props" />

	<PropertyGroup>
		<AssemblyName>Uno.UI</AssemblyName>
		<RootNamespace>Uno.UI</RootNamespace>
		<DefineConstants>$(DefineConstants);IS_UNO;IS_UNO_UI_PROJECT</DefineConstants>
		<UnoDisableAnalyzersForSamples>true</UnoDisableAnalyzersForSamples>
		<BuildForLiveUnitTesting>false</BuildForLiveUnitTesting>
		<NoWarn>$(NoWarn);NU1701;1572;1587;419;1574;1711;1734;CS0105</NoWarn>
		<!-- Disable ILLink analyzer warnings, this assembly is only the reference assembly -->
		<NoWarn>$(NoWarn);IL2026;IL2032;IL2041;IL2043;IL2046;IL2055;IL2057;IL2058;IL2059;IL2060;IL2062;IL2063;IL2064;IL2065;IL2066;IL2067;IL2068;IL2069;IL2070;IL2071;IL2072;IL2073;IL2074;IL2075;IL2076;IL2077;IL2078;IL2079;IL2080;IL2081;IL2082;IL2083;IL2084;IL2085;IL2086;IL2087;IL2088;IL2089;IL2090;IL2091;IL2092;IL2093;IL2094;IL2095;IL2096;IL2097;IL2098;IL2099;IL2103;IL2106;IL2110;IL2111;IL2112;IL2113;IL2114;IL2115;IL2116;IL2122;IL2123;IL2124;IL2125;IL2126;IL3000;IL3001;IL3002;IL3003;IL3004;IL3005;IL3050;IL3051;IL3056;IL3057;IL3058;IL4000;IL4001</NoWarn>
		<IsAotCompatible>true</IsAotCompatible>

		<ProduceReferenceAssembly>false</ProduceReferenceAssembly>
		<Deterministic>true</Deterministic>

		<UnoRuntimeIdentifier>Reference</UnoRuntimeIdentifier>

		<!-- Force the generation of upri files for Uno.UI self localization -->
		<UnoForceProcessPRIResource>true</UnoForceProcessPRIResource>

		<!-- Generate automation IDs in debug builds, use by UI tests. -->
		<IsUiAutomationMappingEnabled Condition="'$(Configuration)'=='Debug'">true</IsUiAutomationMappingEnabled>

		<!-- Disable WPF targets -->
		<ImportFrameworkWinFXTargets>false</ImportFrameworkWinFXTargets>

		<!-- Disabled because of LinkerDefinitionMergerTask performance issues https://github.com/unoplatform/uno/issues/9632 -->
		<!--<UnoXamlResourcesTrimming Condition="'$(Configuration)'!='Debug'">true</UnoXamlResourcesTrimming>-->

		<EnableAutomaticXamlPageInclusion>false</EnableAutomaticXamlPageInclusion>
	</PropertyGroup>

	<ItemGroup>
		<UpToDateCheckInput Include="**\*.xaml" Exclude="bin\**\*.xaml;obj\**\*.xaml;Themes\WinUI\Resources\**\*.xaml;" Visible="False" />
		<UpToDateCheckInput Include="**\*.cs" Exclude="bin\**\*.cs;obj\**\*.cs;" Visible="False" />
		<UpToDateCheckInput Include="**\*.tt" Exclude="bin\**\*.tt;obj\**\*.tt;" Visible="False" />
	</ItemGroup>

	<ItemGroup>
		<None Include="Extensions\CGSizeExtensions.iOSmacOS.cs" />
		<None Include="Mixins\Android\BaseActivity.Callbacks.g.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
		</None>
		<None Include="Mixins\Android\FrameworkElementMixins.g.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
		</None>
		<None Include="Mixins\iOS\FrameworkElementMixins.g.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
		</None>
		<None Include="Mixins\macOS\FrameworkElementMixins.g.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
		</None>
		<None Include="Resources\AboutResources.txt" />
		<None Include="Resources\Values\Attrs.xml" />
		<None Include="Resources\Values\Styles.xml" />
		<None Include="Resources\IResourceRegistry.cs" />
		<None Include="Resources\ResourceRegistry.cs" />
	</ItemGroup>

	<ItemGroup>
		<ProjectReference Include="..\Uno.Foundation\Uno.Foundation.Reference.csproj">
			<TreatAsPackageReference>false</TreatAsPackageReference>
		</ProjectReference>
		<ProjectReference Include="..\Uno.UWP\Uno.Reference.csproj">
			<TreatAsPackageReference>false</TreatAsPackageReference>
		</ProjectReference>
		<ProjectReference Include="..\SourceGenerators\System.Xaml\Uno.Xaml.csproj" />
		<ProjectReference Include="..\Uno.UI.Composition\Uno.UI.Composition.Reference.csproj">
			<TreatAsPackageReference>false</TreatAsPackageReference>
		</ProjectReference>
	</ItemGroup>

	<ItemGroup>
		<EmbeddedResource Include="LinkerDefinition.$(TargetFramework).xml" Condition="exists('LinkerDefinition.$(TargetFramework).xml')">
			<LogicalName>$(AssemblyName).xml</LogicalName>
		</EmbeddedResource>
		<EmbeddedResource Include="UI\Xaml\Controls\ProgressRing\*.json" />
	</ItemGroup>

	<PropertyGroup>
		<UnoUIMSBuildTasksPath>$(MSBuildThisFileDirectory)..\SourceGenerators\Uno.UI.Tasks\bin\$(Configuration)_Shadow</UnoUIMSBuildTasksPath>
	</PropertyGroup>

	<Import Project="..\SourceGenerators\Uno.UI.SourceGenerators\Content\Uno.UI.SourceGenerators.props" />
	<Import Project="..\SourceGenerators\Uno.UI.Tasks\Content\Uno.UI.Tasks.targets" Condition="'$(SkipUnoResourceGeneration)' == '' " />

	<ItemGroup>
		<Service Include="{508349b6-6b84-4df5-91f0-309beebad82d}" />
	</ItemGroup>
	<ItemGroup>
		<Folder Include="UI\Xaml\Maps\Presenters\" />
	</ItemGroup>

	<ItemGroup>
		<PRIResource Include="**\*.resw" />
	</ItemGroup>

	<ItemGroup Condition="'$(DocsGeneration)'==''">
		<ProjectReference Include="..\SourceGenerators\Uno.UI.SourceGenerators\Uno.UI.SourceGenerators.csproj">
			<ReferenceOutputAssembly>false</ReferenceOutputAssembly>
			<SkipGetTargetFrameworkProperties>true</SkipGetTargetFrameworkProperties>
			<UndefineProperties>TargetFramework</UndefineProperties>
		</ProjectReference>
		<ProjectReference Include="..\SourceGenerators\Uno.UI.SourceGenerators.Internal\Uno.UI.SourceGenerators.Internal.csproj">
			<ReferenceOutputAssembly>false</ReferenceOutputAssembly>
			<OutputItemType>Analyzer</OutputItemType>
		</ProjectReference>
		<ProjectReference Include="..\SourceGenerators\Uno.UI.Tasks\Uno.UI.Tasks.csproj">
			<ReferenceOutputAssembly>false</ReferenceOutputAssembly>
			<SkipGetTargetFrameworkProperties>true</SkipGetTargetFrameworkProperties>
			<UndefineProperties>TargetFramework</UndefineProperties>
		</ProjectReference>
	</ItemGroup>

	<ItemGroup>
		<None Update="Mixins\Android\BaseActivity.Callbacks.tt">
			<LastGenOutput>BaseActivity.Callbacks.g.cs</LastGenOutput>
		</None>
		<None Update="Mixins\Android\FrameworkElementMixins.tt">
			<LastGenOutput>FrameworkElementMixins.g.cs</LastGenOutput>
		</None>
		<None Update="Mixins\DependencyPropertyMixins.tt">
			<LastGenOutput>DependencyPropertyMixins.g.cs</LastGenOutput>
		</None>
		<None Update="Mixins\iOS\FrameworkElementMixins.tt">
			<LastGenOutput>FrameworkElementMixins.g.cs</LastGenOutput>
		</None>
		<None Update="Mixins\macOS\FrameworkElementMixins.tt">
			<LastGenOutput>FrameworkElementMixins.g.cs</LastGenOutput>
		</None>
	</ItemGroup>

	<Import Project="MixinGeneration.targets" />

	<!-- Empty GetTargetPath target to prevent build errors when project is referenced but not actually built -->
	<Target Name="GetTargetPath" />
</Project>
