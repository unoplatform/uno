<Project Sdk="Uno.Sdk.Private">
    <PropertyGroup>
        <TargetFrameworks>net10.0-desktop;net10.0-browserwasm</TargetFrameworks>

        <OutputType>Exe</OutputType>
        <UnoSingleProject>true</UnoSingleProject>

        <!-- Display name -->
        <ApplicationTitle>uno56netcurrent</ApplicationTitle>
        <!-- App Identifier -->
        <ApplicationId>com.companyname.uno56netcurrent</ApplicationId>
        <!-- Versions -->
        <ApplicationDisplayVersion>1.0</ApplicationDisplayVersion>
        <ApplicationVersion>1</ApplicationVersion>
        <!-- Package Publisher -->
        <ApplicationPublisher>uno56netcurrent</ApplicationPublisher>
        <!-- Package Description -->
        <Description>uno56netcurrent powered by Uno Platform.</Description>

        <!--
      UnoFeatures let's you quickly add and manage implicit package references based on the features you want to use.
      https://aka.platform.uno/singleproject-features
    -->
        <UnoFeatures>
            SkiaRenderer;
        </UnoFeatures>
    </PropertyGroup>

    <Target Name="_UnoValidateRuntimeTargets" AfterTargets="Build">
        <ItemGroup>
            <_FilteredRuntimeCopyLocalItems
              Include="@(RuntimeCopyLocalItems)"
              Condition=" '%(Filename)' == 'Uno.UI.RemoteControl'
                  and $([System.String]::Copy('%(RelativeDir)').Replace('\','/').ToLowerInvariant().Contains('net9.0/skia')) " />
        </ItemGroup>

        <Error Text="The project must not reference Uno.UI.RemoteControl.dll from a net9.0 folder."
               Condition=" '@(_FilteredRuntimeCopyLocalItems)' != '' " />
    </Target>

    <Target Name="_UnoValidatePublishAotAndUnoBindableDescriptorXml"
            Condition=" '$(PublishAot)' == 'true' "
            AfterTargets="Build">
        <PropertyGroup>
            <_UnoBindableDescriptorXmlPath>$(IntermediateOutputPath)Uno.Bindable.Descriptor.xml</_UnoBindableDescriptorXmlPath>
        </PropertyGroup>
        <Error Text="The Uno.Bindable.Descriptor.xml was not generated!"
                Condition="!Exists('$(_UnoBindableDescriptorXmlPath)')" />
        <ReadLinesFromFile
                File="$(_UnoBindableDescriptorXmlPath)">
            <Output TaskParameter="Lines" ItemName="_UnoBindableDescriptorXmlLines" />
        </ReadLinesFromFile>
        <Message Text="# jonp: Uno.Bindable.Descriptor.xml contents:" Importance="High" />
        <Message Text="@(_UnoBindableDescriptorXmlLines, '
')" Importance="High" />
        <XmlPeek
                XmlInputPath="$(_UnoBindableDescriptorXmlPath)"
                Query="/linker/assembly[@fullname='Uno']/type[@fullname='Windows.UI.Color']">
            <Output TaskParameter="Result" ItemName="_UnoPreserveColor" />
        </XmlPeek>
        <Error Text="`Windows.UI.Color` not present within `Uno.Bindable.Descriptor.xml`!"
                Condition=" @(_UnoPreserveColor->Count()) == 0 " />
    </Target>

</Project>
