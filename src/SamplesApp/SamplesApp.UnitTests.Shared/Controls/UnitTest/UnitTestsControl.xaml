<UserControl
    x:Class="Uno.UI.Samples.Tests.UnitTestsControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:not_skia="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:skia="http://platform.uno/skia"
    x:Name="UnitTestsRootControl"
    d:DesignHeight="300"
    d:DesignWidth="400"
    mc:Ignorable="d skia">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition x:Name="failedTestDetailsRow" Height="0" />
            <!--  Will be set to height = 100 if any exception  -->
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="outputColumn" Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <StackPanel Grid.Row="0" Spacing="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Button
                    x:Name="runButton"
                    Grid.Row="0"
                    Grid.Column="0"
                    HorizontalAlignment="Stretch"
                    Click="OnRunTests">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <SymbolIcon Symbol="Play" />
                        <TextBlock Text="Run" />
                    </StackPanel>
                </Button>
                <Button
                    x:Name="stopButton"
                    Grid.Row="0"
                    Grid.Column="1"
                    HorizontalAlignment="Stretch"
                    Click="OnStopTests"
                    IsEnabled="False">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <SymbolIcon Symbol="Stop" />
                        <TextBlock Text="Stop" />
                    </StackPanel>
                </Button>
                <Button Grid.Column="3">
                    <Button.Content>
                        <SymbolIcon Symbol="Setting" />
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel>
                                <ToggleButton x:Name="consoleOutput">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xED0D;" />
                                        <TextBlock Text="Console Output" />
                                    </StackPanel>
                                </ToggleButton>
                                <ToggleButton x:Name="runIgnored">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xEE35;" />
                                        <TextBlock Text="Run ignored tests" />
                                    </StackPanel>
                                </ToggleButton>
                                <ToggleButton x:Name="retry" IsChecked="True">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xEC57;" />
                                        <TextBlock Text="Auto retry" />
                                    </StackPanel>
                                </ToggleButton>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>

                <TextBox
                    x:Name="testFilter"
                    Grid.Row="1"
                    Grid.ColumnSpan="3"
                    Margin="0,0,4,0"
                    HorizontalAlignment="Stretch"
                    PlaceholderText="Enter test filter here" />
            </Grid>

            <StackPanel Margin="0,8" Orientation="Horizontal">
                <TextBlock Text="Status: " />
                <TextBlock x:Name="runStatus" Text="Not initialized" />
            </StackPanel>

            <Grid Margin="4" RowSpacing="4">
                <Grid.Resources>
                    <Style TargetType="StackPanel">
                        <Setter Property="Background" Value="Transparent" />
                    </Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="VerticalAlignment" Value="Center" />
                        <Setter Property="Width" Value="40" />
                    </Style>
                    <Style TargetType="FontIcon">
                        <Setter Property="VerticalAlignment" Value="Center" />
                    </Style>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackPanel ToolTipService.ToolTip="Total tests">
                    <FontIcon Glyph="&#xE768;" />
                    <TextBlock x:Name="runTestCount" Text="None" />
                </StackPanel>

                <StackPanel Grid.Column="1" ToolTipService.ToolTip="Succeeded tests">
                    <FontIcon Foreground="DarkGreen" Glyph="&#xE73E;" />
                    <TextBlock
                        x:Name="succeededTestCount"
                        Foreground="DarkGreen"
                        Text="None" />
                </StackPanel>

                <StackPanel Grid.Column="2" ToolTipService.ToolTip="Failed tests">
                    <FontIcon Foreground="Red" Glyph="&#xE711;" />
                    <TextBlock
                        x:Name="failedTestCount"
                        Foreground="Red"
                        Text="None" />
                </StackPanel>

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="0"
                    ToolTipService.ToolTip="Inconclusive tests">
                    <FontIcon Foreground="DarkGray" Glyph="&#xE9CE;" />
                    <TextBlock
                        x:Name="inconclusiveTestCount"
                        Foreground="DarkViolet"
                        Text="None" />
                </StackPanel>

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="1"
                    ToolTipService.ToolTip="Ignored tests">
                    <FontIcon Foreground="DarkGray" Glyph="&#xEE35;" />
                    <TextBlock
                        x:Name="ignoredTestCount"
                        Foreground="DarkGray"
                        Text="None" />
                </StackPanel>
            </Grid>
        </StackPanel>

        <ScrollViewer
            Grid.Row="1"
            HorizontalScrollBarVisibility="Auto"
            HorizontalScrollMode="Auto"
            VerticalScrollBarVisibility="Auto"
            VerticalScrollMode="Auto">
            <TextBlock
                x:Name="failedTestDetails"
                IsTextSelectionEnabled="True"
                Opacity="0.8" />
        </ScrollViewer>
        <Button
            Grid.Row="1"
            Margin="0,0,24,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Click="CopyFailedTestDetails">
            <TextBlock Text="Copy" />
        </Button>

        <Rectangle
            Grid.Row="2"
            Height="5"
            HorizontalAlignment="Stretch"
            Fill="{ThemeResource SystemControlForegroundAccentBrush}"
            ManipulationDelta="UpdateFailedTestDetailsSize"
            ManipulationMode="TranslateY" />

        <TextBlock x:Name="failedTests" Grid.Row="3" />
        <TextBlock x:Name="runningState" Grid.Row="3" />
        <ScrollViewer Grid.Row="3">
            <StackPanel x:Name="testResults" Background="Black" />
        </ScrollViewer>
        <Button
            Grid.Row="3"
            Margin="0,0,24,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Click="CopyTestResults">
            <TextBlock Text="Copy" />
        </Button>

        <Rectangle
            Grid.RowSpan="4"
            Grid.Column="1"
            Width="5"
            VerticalAlignment="Stretch"
            Fill="{ThemeResource SystemControlForegroundAccentBrush}"
            ManipulationDelta="UpdateOuputSize"
            ManipulationMode="TranslateX" />

        <ContentControl
            x:Name="unitTestContentRoot"
            Grid.RowSpan="4"
            Grid.Column="2"
            VerticalAlignment="Top"
            HorizontalContentAlignment="Left" />
    </Grid>
</UserControl>
