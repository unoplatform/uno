# Pagefind Search Configuration

This document outlines the configuration and maintenance of the Pagefind static search engine used in the Uno Platform documentation.

## Overview

Pagefind is a static search library that runs after the site build to generate a search index. It indexes the static HTML files generated by DocFX.

## Integration

The Pagefind indexing process is integrated into the Gulp build pipeline defined in `gulpfile.js`.

The `pagefind` task executes the indexing:
```javascript
function pagefind(done) {
    exec('npx pagefind --site _site', (err, stdout, stderr) => {
        // ...
    });
}
```

This command indexes the content in the `_site` directory (the default output of DocFX).

## Indexing Strategy

We utilize **Inclusion-based Indexing** to ensure high relevance and avoid noise from navigation, footers, and sidebars.

### The `data-pagefind-body` Attribute

Instead of explicitly excluding common UI elements (Blacklisting), we explicitly define the content area to be indexed (Whitelisting).

In `templates/uno/layout/_master.tmpl`, the main article container is tagged with `data-pagefind-body`:

```html
<article class="content wrap" id="_content" data-uid="{{uid}}" data-pagefind-body>
    {{!body}}
</article>
```

**Behavior:**
1. Pagefind detects `data-pagefind-body` on the page.
2. It **only** indexes the content within this element.
3. Everything else (Navbar, TOC, Affix sidebar, Footer) is automatically ignored.

### Ignoring Specific Elements

If you need to exclude a specific element *inside* the main article (e.g., a "Share" button or an embedded advertisement), use the `data-pagefind-ignore` attribute:

```html
<div class="share-buttons" data-pagefind-ignore>
    <!-- This content will not be indexed -->
</div>
```

## Maintenance

### Updating Pagefind
To update the Pagefind version, update the package in `package.json` (or `npx` version if specified) and rebuild the documentation.

### Troubleshooting
- **Search results include navigation text**: Ensure `data-pagefind-body` is correctly present on the `<article>` tag in `_master.tmpl`.
- **Search is missing content**: Ensure the content is valid HTML and resides within the `data-pagefind-body` element.
- **Weights**: If titles or specific sections need higher priority, use `data-pagefind-weight="10"`.

## References
- [Pagefind Documentation](https://pagefind.app/)
- [Pagefind Indexing Configuration](https://pagefind.app/docs/indexing/)
